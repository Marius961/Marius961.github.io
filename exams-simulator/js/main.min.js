let obj={questions:[]},correctAnswers=0,animationTime=150,questionsContainer=$("#questions"),fileLoadContainer=$("#fileLoadContainer"),resultContainer=$("#resultContainer"),resultLabel=$("#result"),questionCountLabel=$("#questionsCountLabel"),correctAnswersPercentageLabel=$("#correctPercentage"),assessmentLabel=$("#assessmentLabel"),loadingContainerId="loadAnimation",correctOptionClassName="correct-answer",wrongOptionClassName="wrong-answer",wrongAnswersBtnText="Показати неправильні відповіді";function clearData(){$(resultLabel).empty(),$(questionCountLabel).empty(),$(assessmentLabel).empty(),$(correctAnswersPercentageLabel).empty(),$("#wrongAnswersContainer").empty(),$("#wrongAnswersBtn").remove()}function calculateAssessment(n){return n<50?"2":n>=50&&n<56?"3 (достатньо)":n>=56&&n<63?"3":n>=63&&n<80?"4 (добре)":n>=80&&n<88?"4 (дуже добре)":n>=88?"5 відмінно":void 0}function parseQuestionToObject(n,e){let t=e.split("\n"),o=t[0],i=0,s=[];t.shift();for(let n=0;n<t.length;n++){let e=t[n].trim();""!==e&&("+"===e.substr(0,1)&&(i=n,e=e.substr(1)),s.push({id:n,text:e}))}addQuestionToObject(n,o,i,s)}function addQuestionToObject(n,e,t,o){obj.questions.push({id:n,question:e,answerId:t,options:o})}function shuffledArray(n){return n.sort(function(){return Math.random()-.5})}function parseTxtToObject(n){let e=n.target.result.split(/\n\s*\n|\r\n\s*\r\n/);for(let n=0;n<e.length;n++)""!==e[n].trim()&&parseQuestionToObject(n,e[n]);addQuestionsWithOptions(obj)}function addQuestionsWithOptions(n){let e=$("#shuffleQuestions").is(":checked"),t=$("#shuffleOptions").is(":checked"),o=$("#expressTest").is(":checked")&&n.questions.length>30;e&&(n.questions=shuffledArray(n.questions)),o&&(n.questions.length=30),$.each(n.questions,function(n,e){let o="question"+e.id,i=+n+1+") ";$("#questions").append("<div class='row mt-5 pt-4' id='"+o+"'>\n   <div class='col-12 question-text'>"+i+e.question+"</div>\n</div>"),t&&(e.options=shuffledArray(e.options)),$.each(e.options,function(n,t){let i="q"+e.id+"v"+t.id;$("#"+o).append("<div class='col-12'>   <div class='row custom-control custom-radio ml-sm-4 pl-5 pt-2 pb-2 option-2'>\n       <input type='radio' class='col-auto custom-control-input' name='q"+e.id+"' id='"+i+"'>\n       <label class='col-12 custom-control-label option-1' for='"+i+"'>"+t.text+"</label>\n   </div></div>")})}),$("#questions").append('<div class="row justify-content-center mt-3 mb-3">\n   <div class="col-auto btn-orange-primary p-2 mt-3" id=\'calculateResult\'>Завершити</div>\n</div>'),removeLoadingContainer(),setTimeout(function(){fadeInContainer(questionsContainer)},animationTime)}function fadeOutContainer(n){$(n).fadeOut(animationTime)}function fadeInContainer(n){$("html, body").animate({scrollTop:0},800),$(n).fadeIn(animationTime)}function addLoadingContainer(){let n="<div class='row justify-content-center text-center' id='"+loadingContainerId+"'>\n        <div class='col-auto lds-hourglass'></div>\n        <div class='col-12 text-center loading-text'>Завантаження</div>\n    </div>";$("main").append(n),$("#"+loadingContainerId).fadeIn(animationTime).css("display","flex")}function removeLoadingContainer(){$("#"+loadingContainerId).fadeOut(animationTime),setTimeout(function(){$("#"+loadingContainerId).remove()},animationTime)}function logQuestion(n,e,t){let o="la"+n.id;$("#wrongAnswersContainer").append("<div class='row mt-1 pt-4' id='"+o+"'>\n<div class='col-12 question-text'>"+n.question+"</div>\n</div>");let i="";$(n.options).each(function(n,s){i=+s.id==+t?correctOptionClassName:+s.id==+e?wrongOptionClassName:"",$("#"+o).append("<div class='col-12'>\n   <div class="+i+"'row ml-sm-4 pl-5 pt-2 pb-2 option-2 '>\n       <label class='col-12 option-1'>"+s.text+"</label>\n   </div>\n</div>")})}$(document).ready(function(){function n(n){obj=JSON.parse(n.target.result),removeLoadingContainer(),setTimeout(function(){addQuestionsWithOptions(obj)},animationTime)}document.getElementById("file").addEventListener("change",function(e){fadeOutContainer(fileLoadContainer),setTimeout(function(){addLoadingContainer()},animationTime);let t=new FileReader,o=e.target.files[0].name,i=o.lastIndexOf("."),s=o.substr(i);".json"===s&&(t.onload=n),".txt"===s?t.onload=parseTxtToObject:(swal({title:"Формат файлу не підтримується!",text:"Будь ласка оберіть файл у форматі TXT або JSON",icon:"warning",button:"ОК"}),removeLoadingContainer(),$("#file").val(),fadeInContainer(fileLoadContainer)),t.readAsText(e.target.files[0])})}),$(document).on("click","#calculateResult",function(){let n=$("input[type=radio]:checked"),e=obj.questions.length;if(n.length===e){let t=0;$(n).each(function(n,e){let o=$(e).attr("id"),i=o.substr(o.lastIndexOf("q")+1,o.lastIndexOf("v")-1),s=o.substr(o.lastIndexOf("v")+1),a=0;$(obj.questions).each(function(n,e){if(+e.id==+i)return a=e.answerId,+s==+a?correctAnswers++:(t++,logQuestion(e,s,a)),!1})});let o=100/e*correctAnswers;fadeOutContainer(questionsContainer),$(resultLabel).append(correctAnswers),$(questionCountLabel).append(obj.questions.length),$(correctAnswersPercentageLabel).append(o.toFixed(1)+"%"),$(assessmentLabel).append(calculateAssessment(o.toFixed(1))),0!==t&&$("#logContainer").prepend("<div class='col-12 btn-orange-secondary-borderLess p-2' id='wrongAnswersBtn'>"+wrongAnswersBtnText+" ("+t+")</div>"),setTimeout(function(){fadeInContainer(resultContainer)},animationTime)}else swal({text:"Будь ласка дайте відповідь на всі питання щоб завершити тестування",icon:"warning",button:"Продовжити"});correctAnswers=0}),$(document).on("click","#retry",function(){$(questionsContainer).empty(),addQuestionsWithOptions(obj),fadeOutContainer(resultContainer),setTimeout(function(){clearData(),fadeInContainer(questionsContainer)},animationTime)}),$(document).on("click","#choseFile",function(){$(questionsContainer).empty(),fadeOutContainer(resultContainer),setTimeout(function(){clearData(),fadeInContainer(fileLoadContainer)},animationTime),$("#file").val(""),obj={questions:[]}}),$(document).on("click",".params-label",function(){$("#testParams").slideToggle(animationTime)}),$(document).on("click","#wrongAnswersBtn",function(){$("#wrongAnswersContainer").slideToggle(animationTime)}),$(document).on("click","input[type=radio]",function(){let n=$(this).attr("name");$("input[name="+n+"]").each(function(n,e){$(e.parentNode).removeClass("selected-option")}),$(this.parentNode).addClass("selected-option")}),$("#info-btn").click(function(){$("#info-container").slideToggle(animationTime)}),$("#menuBtn").click(function(){$("#menuContent").slideToggle(animationTime)}),$(function(){$('[data-toggle="tooltip"]').tooltip()});